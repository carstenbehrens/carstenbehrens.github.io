{"hash":"a758d941048f8bb96e1e504dd4f672f1ed7b0c28","data":{"post":{"title":"How to add Request Headers to an IFrame src request","date":"July 28, 2021","content":"<p>In this blog post, you'll learn how to send a request header while fetching an iframe.</p>\n<p>One possible use case for this method is, that you can send an authentication token (<a href=\"https://jwt.io/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">JWT</a>) to your iframe URL.</p>\n<h1 id=\"the-solution\"><a href=\"#the-solution\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>The Solution</h1>\n<p>Since there is no HTML-Only solution for this problem we'll need some JavaScript.</p>\n<p>Here is an simple vanilla JS example:</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">&lt;iframe&gt;&lt;/iframe&gt;</span></span>\n<span class=\"line\"><span style=\"color: #ECEFF4\">  </span><span style=\"color: #81A1C1\">&lt;script&gt;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #81A1C1\">async</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">function</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">getSrc</span><span style=\"color: #ECEFF4\">()</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">      </span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">res</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">await</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #88C0D0\">fetch</span><span style=\"color: #D8DEE9FF\">(</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">http://example.com/someiframe</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        </span><span style=\"color: #88C0D0\">method</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #A3BE8C\">GET</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #ECEFF4\">,</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        </span><span style=\"color: #88C0D0\">headers</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span></span>\n<span class=\"line\"><span style=\"color: #ECEFF4\">          </span><span style=\"color: #616E88\">// Here you can set any headers you want</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">        </span><span style=\"color: #ECEFF4\">}</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">      </span><span style=\"color: #ECEFF4\">}</span><span style=\"color: #D8DEE9FF\">)</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">      </span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">blob</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">await</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">res</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">blob</span><span style=\"color: #D8DEE9FF\">()</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">      </span><span style=\"color: #81A1C1\">const</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">urlObject</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">URL</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">createObjectURL</span><span style=\"color: #D8DEE9FF\">(</span><span style=\"color: #D8DEE9\">blob</span><span style=\"color: #D8DEE9FF\">)</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">      </span><span style=\"color: #D8DEE9\">document</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">querySelector</span><span style=\"color: #D8DEE9FF\">(</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #A3BE8C\">iframe</span><span style=\"color: #ECEFF4\">&#39;</span><span style=\"color: #D8DEE9FF\">)</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #88C0D0\">setAttribute</span><span style=\"color: #D8DEE9FF\">(</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">src</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #ECEFF4\">,</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #D8DEE9\">urlObject</span><span style=\"color: #D8DEE9FF\">)</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #ECEFF4\">}</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #88C0D0\">getSrc</span><span style=\"color: #D8DEE9FF\">()</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #81A1C1\">&lt;/script&gt;</span></span></code></pre>\n<p><strong>So what's happening here?</strong></p>\n<ol>\n<li>We fetch the iframe using the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Fetch API</a>.</li>\n<li>We use the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Response/blob\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Response.blob()</a> method which returns a promise that resolved into a Blob. The <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Blob\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Blob</a> object allows us to store the iframe as raw data.</li>\n<li>Using the <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">URL.createObjectUrl()</a> method and the Blob as an argument, we create an object URL which is then inserted as the source of our iframe.</li>\n</ol>\n","tags":[{"title":"iframe","path":"/tag/iframe/"},{"title":"JWT","path":"/tag/JWT/"}]}},"context":{}}