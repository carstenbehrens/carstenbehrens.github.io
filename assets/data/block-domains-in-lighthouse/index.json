{"hash":"3d3c9a9b43e58f27347bb2560c2db1e7b2af0959","data":{"post":{"title":"How to block domains in Lighthouse","date":"June 6, 2020","content":"<p>We all know that third-party JavaScript and Ads have a big impact on performance.</p>\n<p>To know how much of an impact third-party JavaScript and Ads have on our performance we need to be able to measure our\nwebsites performance without them.</p>\n<p>As of now, this feature is not available in google chrome directly, so we have to use the Lighthouse CLI.</p>\n<h2 id=\"1-download-the-lighthouse-cli\"><a href=\"#1-download-the-lighthouse-cli\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>1. Download the Lighthouse CLI</h2>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">  npm install -g lighthouse</span></span></code></pre>\n<h2 id=\"2-create-a-lighthouse-config-file\"><a href=\"#2-create-a-lighthouse-config-file\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>2. Create a Lighthouse config file</h2>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #8FBCBB\">module</span><span style=\"color: #ECEFF4\">.</span><span style=\"color: #8FBCBB\">exports</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #81A1C1\">=</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">  </span><span style=\"color: #88C0D0\">extends</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">lighthouse:default</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #ECEFF4\">,</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">  </span><span style=\"color: #88C0D0\">settings</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #ECEFF4\">{</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #88C0D0\">onlyCategories</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> [</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">performance</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #D8DEE9FF\">]</span><span style=\"color: #ECEFF4\">,</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    </span><span style=\"color: #88C0D0\">blockedUrlPatterns</span><span style=\"color: #ECEFF4\">:</span><span style=\"color: #D8DEE9FF\"> [</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">      </span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">*upscore.com*</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #ECEFF4\">,</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">      </span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">*connect.facebook*</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #ECEFF4\">,</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">      </span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">*google-analytics.com*</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #ECEFF4\">,</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">    ]</span><span style=\"color: #ECEFF4\">,</span></span>\n<span class=\"line\"><span style=\"color: #D8DEE9FF\">  </span><span style=\"color: #ECEFF4\">},</span></span>\n<span class=\"line\"><span style=\"color: #ECEFF4\">}</span><span style=\"color: #81A1C1\">;</span></span></code></pre>\n<p>You use the blockedUrlPatterns array to specify which domains you want to\nblock.</p>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">*test.com</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #81A1C1\">;</span><span style=\"color: #D8DEE9FF\"> </span><span style=\"color: #616E88\">// Blocks https://somethingtest.com</span></span></code></pre>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #A3BE8C\">*test*</span><span style=\"color: #ECEFF4\">&quot;</span><span style=\"color: #81A1C1\">;</span></span>\n<span class=\"line\"><span style=\"color: #616E88\">// Blocks https://somethingtest.com</span></span>\n<span class=\"line\"><span style=\"color: #616E88\">// Blocks https://testsomething.com</span></span></code></pre>\n<p>There is no other way to block domains using more complex patterns.</p>\n<h2 id=\"3-run-lighthouse\"><a href=\"#3-run-lighthouse\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>3. Run Lighthouse</h2>\n<pre class=\"shiki\" style=\"background-color: #2e3440ff\"><code><span class=\"line\"><span style=\"color: #D8DEE9FF\">lighthouse --config-path=path/to/custom-config.js https://example.com</span></span></code></pre>\n<h2 id=\"4-get-correct-results\"><a href=\"#4-get-correct-results\" aria-hidden=\"true\"><span class=\"icon icon-link\"></span></a>4. Get correct results</h2>\n<p>Make sure to run Lighthouse at least 3 times if you want somewhat accurate\nresults.</p>\n","tags":[{"title":"Frontend","path":"/tag/Frontend/"},{"title":"JavaScript","path":"/tag/JavaScript/"}]}},"context":{}}